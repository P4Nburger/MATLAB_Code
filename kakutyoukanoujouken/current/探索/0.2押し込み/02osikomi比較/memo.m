%% optimal_design_snapthrough_found.m
% ========================================================================
% 発見日: 2026年1月19日
% 目的: 音波駆動でスナップスルーが確実に起きる設計条件の特定
% 手法: 960設計点のパラメータ探索（20コア並列、6分）
% ========================================================================

%% 【重要な発見】スナップスルー可能な最適設計
% 初期たわみ最大化 + 共振振幅最大化の観点から、順位16が最適

optimal_design = struct(...
    'x_push_mm', 0.200, ...      % 押し込み量 [mm]
    'w1_stiff_mm', 0.10, ...     % 最小膜幅 [mm] (下限値)
    'w1_mass_mm', 60.0, ...      % 平均幅 [mm] (受圧面積大)
    'L_mm', 15.0, ...            % スパン [mm] (最短)
    't1_mm', 0.1, ...            % 膜厚 [mm] (固定)
    'E1_GPa', 3.45, ...          % ヤング率 [GPa] (PLA)
    'rho1', 1250, ...            % 密度 [kg/m^3]
    'P0_Pa', 2, ...              % 音圧上限 [Pa]
    'delta', 0.05, ...           % 減衰比 [-]
    'C_eff', 0.2794 ...          % 形状定数 [-]
);

%% 【結果】スナップスルー判定
results = struct(...
    'z_eq_mm', 1.197, ...        % 初期たわみ [mm]
    'A_z_mm', 1.677, ...         % 共振時の膜振幅 [mm] (初期たわみの1.4倍)
    'f_res_Hz', 33.0, ...        % 共振周波数 [Hz]
    'snapthrough', true ...      % z変位がゼロをクロス → 拡張可能
);

%% 【物理的解釈】
% 1. 初期たわみ z_eq = sqrt(2*x_push/C_eff) = 1.197 mm
%    → 大きな初期座屈が形成されている
%
% 2. 共振振幅 A_z = 1.677 mm > z_eq
%    → 音波で初期たわみを超える振幅が出る
%    → 膜がゼロをクロスして反対側に座屈（スナップスルー）
%
% 3. 共振周波数 33 Hz
%    → 低周波でエネルギー効率が良い
%    → 実験装置で容易に発生可能
%
% 4. 設計のポイント:
%    - w1_stiff を最小化 → 剛性低下 → 振幅増大
%    - w1_mass を大型化 → 受圧面積増 → 外力増大 → 振幅増大
%    - L を最小化 → 共振周波数低下 → 実験しやすい

%% 【次のステップ】
% 1. x_push を 1.0 mm まで拡大して、さらに大きな初期たわみを探索
% 2. スナップスルー後の拡張維持ロジックを実装
% 3. この設計条件で実験試作・検証

%% 【探索条件】
% 設計変数:
%   x_push:   0.02~0.20 mm (8点)
%   w1_stiff: 0.1, 0.5, 1, 2, 5 mm (5点)
%   w1_mass:  10, 20, 40, 60, 80, 100 mm (6点)
%   L:        15, 18, 21, 25 mm (4点)
% 総設計点数: 960点
% 計算環境: Xeon 4416+ (20コア、Threads並列)
% 計算時間: 6分

fprintf('Optimal design parameters loaded.\n');
fprintf('z_eq = %.3f mm, A_z = %.3f mm, f_res = %.1f Hz\n', ...
    results.z_eq_mm, results.A_z_mm, results.f_res_Hz);
fprintf('Snapthrough confirmed: z crosses zero.\n');
